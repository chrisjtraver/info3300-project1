<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script> <!--D3 Library Import-->
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"> </script> <!--JQuery Library Import-->
  <script src="data.json"></script> <!--Arrest Data Import-->
  <link rel="stylesheet" type="text/css" href="style.css"> <!--External CSS Import-->
  <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'> <!--Import Open Sans Font-->
</head>

<body>
<h1 class="center">Trends in NYC Marijuanna Arrests</h1>
<h3 class="center">Chris Traver, Leila Younes, Chris Yoo</h3>

<h3> Arrest Prices by Location </h3>
<p>This map displays all of the arrests for marijuana related offenses in NYC between January 1st, 2014 and December 31st, 2014.
The street price of marijuana at the arrest data is signified by the color of the data point, which is also explained in the scale to the left
of the map.  As you can see, most of the marijuana related arrests occurred in clumps throughout the 5 boroughs.</p>
<div class="map"></div>

<h3> Steam Graph </h3>
<p>This map displays all of the arrests for marijuana related offenses in NYC between January 1st, 2014 and December 31st, 2014.
The street price of marijuana at the arrest data is signified by the color of the data point, which is also explained in the scale to the left
of the map.  As you can see, most of the marijuana related arrests occurred in clumps throughout the 5 boroughs.</p>

<h3> Demographic Data </h3>
<p>The graphs below display demographic data of marijuana related arrests in NYC.  The graphs include things like gender, race, age, etc.</p>
<div class="demographics"></div>

<h3>Marijuana Prices over Time</h3>
<p>This graph looks at the trends in the street price of marijuana in New York City from January 1st, 2014 to December 31st, 2014.  There are
prices for each day, however, we displayed the scale on the x-axis using only the months to make it more readable for the user.</p>
<div class="price-over-time"></div>


<!-- ////////////////////////////////////////// NYC MAP PROJECTION ///////////////////////////////////////////////////-->

<script>
  
//Attributes for NYC Map
var mapWidth = 1200;
var mapHeight = 800;

//Create NYC Map
var svg = d3.select(".map").append("svg")
    .attr("width", mapWidth)
    .attr("height", mapHeight)
	.attr("class", "map");

  //Map Projection Function
  d3.json("nyc.json", function(error, nyb) {

    var projection = d3.geo.mercator()
  					.center([-73.94, 40.70])
  					.scale(65000)
  					.translate([(mapWidth) / 2 + 200, (mapHeight)/2]);

	var path = d3.geo.path()
			.projection(projection);

	var g = svg.append("g");

	g.append("g")
		.attr("class", "boroughs")
		.selectAll(".state")
		.data(nyb.features)
		.enter().append("path")
		.attr("class", function(d){ return "borough-"+d.properties.boroughCode; })
		.attr("d", path);
	
		
<!-- ////////////////////////////////////////// PLOT CIRCLES ON MAP ///////////////////////////////////////////////////-->
	
	for (i = 0; i < data.length; i++) {
		var lonlat = [data[i].lon, data[i].lat];
		var xy = projection(lonlat)
		svg.append("circle")
		.attr({
		  cx: xy[0],
		  cy: xy[1],
		  r: 5,
		  fill: gradientScale(data[i].price),
		})
		.attr("stroke", "black")
	}
  
<!-- ////////////////////////////////////////// BOUROUGH LABELS ///////////////////////////////////////////////////-->

//Staten Island
svg.append("text")
				.attr("x", "40%")
				.attr("y", "55%")
				.attr("class", "map-label")
				.text("Staten Island")

//Manhattan
svg.append("text")
				.attr("x", "45%")
				.attr("y", "35%")
				.attr("class", "map-label")
				.text("Manhattan")

//Bronx
svg.append("text")
				.attr("x", "85%")
				.attr("y", "20%")
				.attr("class", "map-label")
				.text("Bronx")

//Queens
svg.append("text")
				.attr("x", "90%")
				.attr("y", "50%")
				.attr("class", "map-label")
				.text("Queens")
				
//Brooklyn
svg.append("text")
				.attr("x", "53%")
				.attr("y", "80%")
				.attr("class", "map-label")
				.text("Brooklyn")
});
  

<!-- ////////////////////////////////////////// GRADIENT SCALE ///////////////////////////////////////////////////-->

var gradientHeight = 630;
var gradientWidth = 30;
var gradientColors = ["green","red"];
var gradientScale = d3.scale.linear().domain([263.68, 269.11]).range(gradientColors);

var gradientRect = svg.append("defs").append("linearGradient")
    .attr("id", "gradientScale")
    .attr("x1", "0%")
    .attr("y1", "0%")
    .attr("x2", "0%")
    .attr("y2", "100%")

//Leftmost Color
gradientRect.append("stop")
    .attr("stop-color", gradientColors[1])
	.attr("offset", "0%")

//Rightmost Color
gradientRect.append("stop")
    .attr("stop-color", gradientColors[0])
	.attr("offset", "100%")

//Create Gradient Scale Rectangle
svg.append("rect")
    .style("fill", "url(#gradientScale)")
	.attr("x", 200)
    .attr("y", 80)
	.attr("height", gradientHeight)
    .attr("width", gradientWidth)

//Set attributes of Scale		
var height = mapHeight-100;
var width = mapWidth;
var padding = 190;

//Scale Function
var yScale = d3.scale.linear().domain([263.68, 269.11]).range([710, 80]); //domain is same as in HW2

//Create Axis
var yAxis = d3.svg.axis().scale(yScale).orient("left");

//Draw Axis
svg.append("g").attr("transform", "translate(" + padding + ",0)").attr("class", "axis").call(yAxis);

svg.append("text")
            .attr("text-anchor", "middle")
            .attr("transform", "translate("+ (padding/2) +","+(height/2)+")rotate(-90)") 
            .text("Price of Marijuana (in $)") //explain that y scale is in billions
			.style("font-size", 30);
</script>

<!-- ////////////////////////////////////////// STEAM GRAPH ///////////////////////////////////////////////////-->


<!-- ////////////////////////////////////////// DEMOGRAPHIC CHARTS ///////////////////////////////////////////////////-->

<script>

//Simple algo to calculate number of male and female arrests	
var male = 0;
var female = 0;
	for (i = 0; i < data.length; i++) {
	  if (data[i].sex == 0) { //female
        var female = female+1;
      }
	  if (data[i].sex == 1) { //female
        var male = male+1;
      }
	}

var width = 1200;
var height = 300;
var radius = height / 2;
var color = d3.scale.category20c();

var demographicsvg = d3.select('.demographics')
  .append("svg")
  .attr("width", width)
  .attr("height", height);
  
demographicsvg.append("circle")
  .attr("r", 20)
  .attr("cx", 60)
  .attr("cy", 30)
  .attr("fill", "pink");
  
demographicsvg.append("polygon")
  .attr("points", "60,40 30,100 90,100")
  .attr("fill", "pink");

demographicsvg.append("rect")
  .attr("x", 40)
  .attr("y", 100)
  .attr("width", 10)
  .attr("height", 50)
  .attr("fill", "pink");
  
  
</script>

<!-- ////////////////////////////////////////// PRICE OVER TIME LINE CHART ///////////////////////////////////////////////////-->

<script>
//Set width and height of chart
var widthL = 1300;
var heightL = 500;
var svgLine = d3.select(".price-over-time").append("svg")
              .attr("width", widthL).attr("height", heightL);

//Parse dataset			  
var parseDate = d3.time.format("%d-%b").parse;
data.forEach(function(d) {
   d.date = parseDate(d.date);
   d.price = +d.price;
})

//Set attributes for line chart
var padding = 60;
var title = "Title";
var xLabel = "Price";
var yLabel = "Date";

//Add title to the chart
//svgLine.append("text").text("Marijuana Prices over Time").attr("x", 370).attr("y", 20)
//       .attr("alignment-baseline", "middle").attr("font-size", 30);
	   
var xScale = d3.time.scale().range([padding+5,widthL-padding]);
var yScale = d3.scale.linear().domain([d3.min(data, function(d) { return d.price; }) - 1,
                                       d3.max(data, function(d) { return d.price; }) + 1])
                                       .range([heightL-padding,padding]);
									   
xScale.domain(d3.extent(data, function(d) {return d.date; }));

var xAxis = d3.svg.axis()
			  .scale(xScale)
			  .orient("bottom")
			  .ticks(12)
              .ticks(d3.time.months)
			  .tickSize(16, 0)
              .tickFormat(d3.time.format("%B"));
						 
var yAxis = d3.svg.axis()
			  .scale(yScale)
			  .orient("left")
			  .ticks(12)
              .tickFormat(d3.format("s"));
			  
svgLine.selectAll("circle").data(data)
              .enter().append("circle")
              .attr("class", "dot")
              .attr("r", 3.5)
              .attr("fill", "#2eb82e")
              .attr("cx", function(d) {return xScale(d.date);})
              .attr("cy", function(d) {return yScale(d.price);});
			  
svgLine.append("g")
			  .attr("transform", "translate(0," + (heightL - padding) + ")")
              .attr("class", "axis").call(xAxis);
			  
svgLine.append("g")
			  .attr("transform", "translate(" + padding + ",0)")
              .attr("class", "axis").call(yAxis);
			  
			  
// function convertDate(s) {
//   var temp = s.substring(s.length-3, s.length);
//   var orig = s.substring(0, s.length-4);
//
//   switch(s) {
//     case "Jan":
//       s = "1";
//       break;
//     case "Feb":
//       s = "2";
//       break;
//     case "Mar":
//       s = "3";
//       break;
//     case "Apr":
//       s = "4";
//       break;
//     case "May":
//       s = "5";
//       break;
//     case "Jun":
//       s = "6";
//       break;
//     case "July":
//       s = "7";
//       break;
//     case "Aug":
//       s = "8";
//       break;
//     case "Sep":
//       s = "9";
//       break;
//     case "Oct":
//       s = "10";
//       break;
//     case "Nov":
//       s = "11";
//       break;
//     case "Dec":
//       s = "12";
//       break;
//     default:
//       break;
//   }
//   return s+orig;
//
// }
</script>
</body>
</html>